mbedtls_inc = include_directories('include')

crypto_sources = ['aes.c',
                  'aesni.c',
                  'arc4.c',
                  'asn1parse.c',
                  'asn1write.c',
                  'base64.c',
                  'bignum.c',
                  'blowfish.c',
                  'camellia.c',
                  'ccm.c',
                  'cipher.c',
                  'cipher_wrap.c',
                  'cmac.c',
                  'ctr_drbg.c',
                  'des.c',
                  'dhm.c',
                  'ecdh.c',
                  'ecdsa.c',
                  'ecjpake.c',
                  'ecp.c',
                  'ecp_curves.c',
                  'entropy.c',
                  'entropy_poll.c',
                  'error.c',
                  'gcm.c',
                  'havege.c',
                  'hmac_drbg.c',
                  'md.c',
                  'md2.c',
                  'md4.c',
                  'md5.c',
                  'md_wrap.c',
                  'memory_buffer_alloc.c',
                  'oid.c',
                  'padlock.c',
                  'pem.c',
                  'pk.c',
                  'pk_wrap.c',
                  'pkcs12.c',
                  'pkcs5.c',
                  'pkparse.c',
                  'pkwrite.c',
                  'platform.c',
                  'ripemd160.c',
                  'rsa.c',
                  'sha1.c',
                  'sha256.c',
                  'sha512.c',
                  'threading.c',
                  'timing.c',
                  'version.c',
                  'version_features.c',
                  'xtea.c']
x509_sources = ['certs.c',
                'pkcs11.c',
                'x509.c',
                'x509_create.c',
                'x509_crl.c',
                'x509_crt.c',
                'x509_csr.c',
                'x509write_crt.c',
                'x509write_csr.c']
tls_sources = ['debug.c',
               'net_sockets.c',
               'ssl_cache.c',
               'ssl_ciphersuites.c',
               'ssl_cli.c',
               'ssl_cookie.c',
               'ssl_srv.c',
               'ssl_ticket.c',
               'ssl_tls.c']

crypto_lib = static_library('crypto', crypto_sources, include_directories: mbedtls_inc)
crypto_dep = declare_dependency(include_directories: mbedtls_inc, link_with: crypto_lib)
x509_lib = static_library('x509', x509_sources, include_directories: mbedtls_inc)
x509_dep = declare_dependency(include_directories: mbedtls_inc, link_with: x509_lib)
tls_lib = static_library('tls', tls_sources, include_directories: mbedtls_inc)
tls_dep = declare_dependency(include_directories: mbedtls_inc, link_with: tls_lib)

mbedtls_dep = declare_dependency(dependencies: [crypto_dep, x509_dep, tls_dep])
